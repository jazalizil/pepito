objdump -D ../source/pepito > asm
xor_line=$(cat asm | grep -n "<xorKey>:" | cut -d':' -f1)
xor_line=$(echo "$xor_line + 1" | bc)
echo -e "\\033[01;30mxordump -> \\033[00m\\033[01;29m" $(sed -n $xor_line\p asm) "\\033[00m"
xorkey=$(cat asm | sed -n $xor_line\p | cut -f2)
pass_begin=$(cat asm | grep -n "adminPassword" | cut -d':' -f1)
pass_endline=$pass_begin
pass_end=$(cat asm | sed -n $pass_endline\p | awk {'print $1'})
while [ $pass_end != "..." ]
do
  pass_endline=$(echo "$pass_endline + 1" | bc)
  pass_end=$(cat asm | sed -n $pass_endline\p | awk {'print $1'})
done
pass_endline=$(echo "$pass_endline - 1" | bc)
pass_asm=$(cat asm | sed -n $pass_begin,$pass_endline\p | cut -f2)
echo -e "\\033[01;30mpassdump -> \\033[00m\\033[01;29m" $pass_asm "\\033[00m"
xorkey=$(echo "ibase=16 ; $xorkey" | bc)
pass_hex=$(echo $pass_asm | cut -d':' -f2 | sed -e s/\ /\x/g)
./decrypt_pass.py "$pass_hex" "$xorkey"
rm asm
